webpackJsonp([1],{0:function(e,t,a){a("j1ja"),e.exports=a("NHnr")},"7Y5w":function(e,t){},"7zck":function(e,t){},Aik8:function(e,t){},CkjO:function(e,t){},CyLD:function(e,t){},IMfB:function(e,t){},MtUh:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("7+uW"),s=a("3EgV"),n=a.n(s),i=a("/ocq"),o={render:function(){var e=this.$createElement;return(this._self._c||e)("v-alert",{attrs:{value:"true",outline:"",color:"warning",type:"warning"}},[this._v("\n    "+this._s(this.message)+"\n")])},staticRenderFns:[]};var l=a("VU/8")({props:["message"]},o,!1,function(e){a("MtUh")},null,null).exports,c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-layout",{attrs:{row:""}},[t("v-flex",{attrs:{xs12:""}},[t("v-toolbar",[t("v-btn",{attrs:{icon:"",flat:""},on:{click:this.back}},[t("v-icon",[this._v("arrow_back ")])],1),this._v(" "),t("v-toolbar-title",[this._v("Effectuer une demande")])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")({data:function(){return{}},methods:{back:function(){this.$router.go(-1)}}},c,!1,function(e){a("WG81")},null,null).exports,d={data:function(){return{deviceId:"",email:"",pwd:"",user:{},isDriver:!1}},created:function(){var e=this;localStorage.setItem("deviceId","41bccd72a3d20fe5"),e.$router.replace({path:"demand"}),document.addEventListener("deviceReady",function(){document.addEventListener("backbutton",function(e){e.preventDefault()},!1),e.deviceId=device.uuid;var t=localStorage.getItem("deviceId");navigator.splashscreen.hide(),null==t?e.webviewConnexion():(navigator.splashscreen.hide(),e.getUser())},!1)},methods:{getUser:function(){var e=this;$.ajax({url:"http://dev-deliverbag.supconception.fr/mobile/user/"+e.deviceId,type:"GET",datatype:"jsonp",success:function(t){e.user=t,null!=e.user.driver&&(e.isDriver=!0),e.isDriver||e.$router.replace({path:"demand"})},error:function(e){console.log(e)}})},webviewConnexion:function(){var e=this,t=cordova.InAppBrowser.open("http://dev-deliverbag.supconception.fr/connexion","_blank","location=no,zoom=no"),a=this.deviceId;t.addEventListener("loadstop",function(){navigator.splashscreen.hide();var r="$(\"#js-form-login\").append(\"<input type='hidden' id='deviceId' value='"+a+"'>\")";t.executeScript({code:r});window.setInterval(function(){t.executeScript({code:'if($("#test").val()=="ok"){true}else{false}'},function(a){"false"!=a&&(localStorage.setItem("deviceId",e.deviceId),e.getUser(),t.close())})},2e3);t.executeScript({file:"js/mobile/inject.js"})}),t.addEventListener("loaderror",function(){t.executeScript({code:'(alert("loaderror"))'})})}}},v={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-layout",{attrs:{row:"","justify-center":""}},[t("v-container",{attrs:{"fill-height":""}},[t("input",{attrs:{id:"datetimepicker",type:"text"}}),this._v(" "),t("v-layout",{attrs:{row:"","justify-center":"","align-center":""}},[t("v-progress-circular",{attrs:{indeterminate:"",size:70,width:5,color:"green"}})],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(d,v,!1,function(e){a("7Y5w")},null,null).exports,g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"touch",rawName:"v-touch",value:{left:e.swipeLeft,right:e.swipeRight},expression:"{\n    left:swipeLeft ,\n    right:swipeRight\n    }"}]},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-card",{attrs:{"elevation-5":"",to:{name:"demande-form",params:{type:"address"}}}},[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("h3",{staticClass:"headline mb-0 text-xs-center"},[e._v("J'indique une adresse")]),e._v(" "),a("div",[e._v(" Choisissez un lieu et une heure de prise en charge pour vos bagages ")])])])],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-card",{attrs:{"elevation-5":"",to:{name:"demande-form",params:{type:"train"}}}},[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("h3",{staticClass:"headline mb-0 text-xs-center"},[e._v("J'arrive en train")]),e._v(" "),a("div",[e._v(" Vos bagages seront pris en charge à l'arrivée de votre train en gare ")])])])],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-card",{attrs:{"elevation-5":"",to:{name:"demande-form",params:{type:"flight"}}}},[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("h3",{staticClass:"headline mb-0 text-xs-center"},[e._v("Je voyage en avion")]),e._v(" "),a("div",[e._v(" Partez l'esprit serein en indiquant simplement votre numéro de vol ")])])])],1)],1)],1),e._v(" "),a("db-menu")],1)},staticRenderFns:[]};var f=a("VU/8")({data:function(){return{}},methods:{swipeRight:function(){this.$router.replace({path:"courses"})},swipeLeft:function(){this.$router.replace({path:"profile-customer"})}}},g,!1,function(e){a("CkjO")},null,null).exports,m={data:function(){return{headers:[{text:"Distance",value:"distance"},{text:"Prix",value:"price"},{text:"Temps estimé",value:"estimated_time"}],deviceid:"",tabs:["En cours","Passées","Prévues"],demandes:[[],[],[]]}},mounted:function(){var e=this;$.ajax({url:"http://dev-deliverbag.supconception.fr/mobile/deliveries/customers",type:"POST",data:{mobile_token:localStorage.getItem("deviceId")},success:function(t){console.log(t["Non payé"]);for(var a=0;a<t["Non payé"].length;a++)e.demandes[0].push(t["Non payé"][a])},error:function(e){alert(e),console.log(e)}})},methods:{swipeLeft:function(){this.$router.replace({path:"demand"})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"touch",rawName:"v-touch",value:{left:e.swipeLeft},expression:"{\n      left:swipeLeft\n      }"}]},[a("v-tabs",{attrs:{"fixed-tabs":""}},[e._l(e.tabs,function(t){return a("v-tab",{key:t.id},[e._v("\n          "+e._s(t)+"\n        ")])}),e._v(" "),a("v-tabs-items",{attrs:{"v-model":e.tabs}},e._l(e.demandes,function(t){return a("v-tab-item",{key:t.id},[e._v("\n          "+e._s(t)+"\n          "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:t,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.distance))]),e._v(" "),a("td",[e._v(e._s(t.item.price))]),e._v(" "),a("td",[e._v(e._s(t.item.estimated_time))])]}}])})],1)}))],2)],1),e._v(" "),a("db-menu")],1)},staticRenderFns:[]};var b=a("VU/8")(m,h,!1,function(e){a("l+pG")},null,null).exports,_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-bottom-nav",{attrs:{value:!0,active:e.element,fixed:""},on:{"update:active":function(t){e.element=t}}},[a("v-btn",{attrs:{flat:"",color:"green darken-2",value:"left",to:"/courses"}},[a("span",[e._v("Mes courses")]),e._v(" "),a("v-icon",[e._v("history")])],1),e._v(" "),a("v-btn",{attrs:{flat:"",color:"green darken-2",value:"main",to:"/demand"}},[a("span",[e._v("Faire une demande")]),e._v(" "),a("v-icon",[e._v("pan_tool")])],1),e._v(" "),a("v-btn",{attrs:{flat:"",color:"green darken-2",value:"right",to:"/profile-customer"}},[a("span",[e._v("Profil et paramètres")]),e._v(" "),a("v-icon",[e._v("settings")])],1)],1)},staticRenderFns:[]};var y=a("VU/8")({data:function(){return{element:"main"}}},_,!1,function(e){a("tzI6")},"data-v-4901d478",null).exports,x=a("mvHQ"),k=a.n(x),T={props:["type"],data:function(){return{step:0,livraisonDirecte:!0,message:"",minDate:(new Date).toISOString().substring(0,10),date:(new Date).toJSON(),time:new Date,startPlace:"",endPlace:"",error:"",errors:{},authorized:[],sncf_key:"7308cd76-a20f-4f01-9cc3-59d4742bba24",numTrain:"",gares:[],selectedGare:"",flight_app_id:"95a4eb71",flight_app_key:"84cb52736b8c4db53b753b8f87be34a8",numVol:"",bagagesCabine:[],bagagesSoute:[],bagagesAutre:[]}},computed:{compagnyId:function(){return this.numVol.substring(0,2)},flightId:function(){return this.numVol.substring(2,6)},dateFormated:function(){if(null!=this.date)return this.date.getMonth()},dateTime:function(){console.log(this.time);var e=new Date(this.date);return"string"==typeof this.time?(e.setHours(this.time.match(/^(\d+)/)[1]),e.setMinutes(this.time.match(/:(\d+)/)[1])):(e.setHours(this.time.getHours()),e.setMinutes(this.time.getMinutes())),e.toLocaleString()},displayDate:function(){return this.dateTime.substring(0,10)},displayTime:function(){return this.dateTime.substring(12,18)}},methods:{reponse:function(){if(3==this.step){var e={start_position:{name:this.startPlace.name,address:this.startPlace.formatted_address,lat:this.startPlace.geometry.location.lat(),lng:this.startPlace.geometry.location.lng()},end_position:{name:this.endPlace.name,address:this.endPlace.formatted_address,lat:this.endPlace.geometry.location.lat(),lng:this.endPlace.geometry.location.lng()},delivery:{comment:"Un commentaire... sur une demande de prise en charge...",start_date:this.date,livraisonDirecte:this.livraisonDirecte},bagages:{1:this.bagagesCabine,2:this.bagagesSoute,3:this.bagagesAutre},mobile_token:localStorage.getItem("deviceId")};$.ajax({url:"http://dev-deliverbag.supconception.fr/create/delivery",type:"POST",data:e,success:function(e){console.log(e)},error:function(e){console.log(e)}})}return e},openCamera:function(){navigator.camera.getPicture(function(e){},onFail,{quality:100,destinationType:navigator.camera.DestinationType.NATIVE_URI,correctOrientation:!0,encodingType:navigator.camera.EncodingType.JPEG,targetWidth:400,targetHeight:400})},openGalery:function(){navigator.camera.getPicture(function(e){},onFail,{quality:100,destinationType:navigator.camera.DestinationType.NATIVE_URI,sourceType:pictureSource.PHOTOLIBRARY,correctOrientation:!0,targetWidth:400,targetHeight:400})},ajoutBagage:function(e){switch(e){case"cabine":this.bagagesCabine.push({name:"",descr:""});break;case"soute":this.bagagesSoute.push({name:"",descr:""});break;case"autre":this.bagagesAutre.push({name:"",descr:""})}},supprBagage:function(e,t){var a=e.indexOf(t);a>-1&&e.splice(a,1)},resetData:function(){this.numVol="",this.numTrain="",this.gares=[],this.error=""},isFormOk:function(){if(""==this.error&&""!=this.startPlace&&""!=this.endPlace&&""!=this.date&&this.checkErrors())return!0},checkErrors:function(){var e=!0;for(var t in this.errors)""!=this.errors[t]&&(e=!1);return e},verifBagage:function(){return(this.bagagesCabine.length||this.bagagesSoute.length||this.bagagesAutre.length)&&this.bagageOk(this.bagagesAutre)},bagageOk:function(e){var t=[],a=!0;if(e.length)for(var r=0;r<e.length;r++)""==e[r].name?a=!1:t.includes(e[r].name)?a=!1:t.push(e[r].name);return a},verifGare:function(){var e=parseFloat(this.selectedGare.stop_point.coord.lat),t=parseFloat(this.selectedGare.stop_point.coord.lon),a=this.selectedGare.arrival_time;this.time=a.substring(0,2)+":"+a.substring(2,4);var r={lat:e,lng:t},s=this;(new google.maps.Geocoder).geocode({latLng:r},function(e,t){t!==google.maps.GeocoderStatus.OK&&(alert("Erreur lors de l'appel a geocode"),console.log(t)),t==google.maps.GeocoderStatus.OK&&(s.startPlace=e[1],s.verifyDepartment(s.startPlace,"gare"))})},getDepartments:function(){var e=this;$.ajax({url:"https://dev-deliverbag.supconception.fr/departments/authorized",dataType:"jsonp",success:function(t){for(var a=0;a<JSON.parse(t).length;a++)e.authorized.push(JSON.parse(t)[a].number.toString()),e.authorized.push(JSON.parse(t)[a].name)},error:function(e){console.log("error "),console.log(e)}})},getBagages:function(){var e=this;$.ajax({url:"http://dev-deliverbag.supconception.fr/mobile/bags/users/"+localStorage.getItem("deviceId"),type:"GET",datatype:"jsonp",success:function(t){if(t=JSON.parse(t),console.log(k()(t)),e.bagagesCabine=[],e.bagagesSoute=[],e.bagagesAutre=[],t.length)for(var a=0;a<t.length;a++)switch(t[a].type_id){case 1:e.bagagesCabine.push(t[a]);break;case 2:e.bagagesSoute.push(t[a]);break;case 3:e.bagagesAutre.push(t[a])}},error:function(e){alert("erreur de connexion"),console.log(e)}})},geocode:function(e){(new google.maps.Geocoder).geocode({latLng:e},function(e,t){return t!==google.maps.GeocoderStatus.OK?(alert("Erreur lors de l'appel a geocode"),console.log(t),null):t==google.maps.GeocoderStatus.OK?e[1]:void 0})},verifyDepartment:function(e,t){for(var a=e.address_components,r=!1,s=0;s<a.length;s++)for(var n=0;n<a[s].types.length;n++)if("postal_code"==a[s].types[n]||"administrative_area_level_2"==a[s].types[n]){!0;var i=a[s].short_name;(this.authorized.includes(i.substr(0,2))||this.authorized.includes(i))&&(r=!0)}if(r)this.errors[t]="";else{var o="Le lieu souhaité pour la prise en charge";"end"==t&&(o="Le lieu souhaité pour la livraison"),"gare"==t&&(o="Cet arrêt souhaité"),this.errors[t]=o+" n'est pas encore desservi par nos services",console.log(this.errors)}},traitementVol:function(){var e=this,t=this.date.substring(0,4),a=this.date.substring(5,7),r=this.date.substring(8,10);6==this.numVol.length&&$.ajax({url:"https://api.flightstats.com/flex/flightstatus/rest/v2/jsonp/flight/status/"+this.compagnyId+"/"+this.flightId+"/arr/"+t+"/"+a+"/"+r+"?appId="+this.app_id+"&appKey="+this.app_key+"&utc=false",dataType:"jsonp",success:function(t){if(t.flightStatuses.length){var a=t.flightStatuses[0],r=new Date(a.operationalTimes.scheduledGateArrival.dateLocal);a.operationalTimes.estimatedGateArrival&&(r=new Date(a.operationalTimes.estimatedGateArrival.dateLocal)),e.date=r;var s=r.getMinutes();s<10&&(s="0"+s);a.departureAirportFsCode;var n,i,o=a.arrivalAirportFsCode;if(t.appendix.airports.forEach(function(t){if(t.fs==o){console.log(t),n=t.name,i=t.city;var a={lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)};e.geocode(a)}}),a.delays){var l=a.delays.arrivalGateDelayMinutes;l&&console.log("Il y'a un retard de "+l+" minute(s) sur ce vol.")}console.log("Le client sera à la sortie de "+n+" ("+i+") le "+r.getDate()+"/"+(r.getMonth()+1)+"/"+r.getFullYear()+" à "+r.getHours()+"h"+s)}else e.error="Ce numéro de vol ne correspond à aucun vol à cette date"},error:function(t){e.error="Une erreur inconnue est survenue lors de la recherche de ce vol",console.log(t)}})},traitementTrain:function(){var e=this;if(4==this.numTrain.length){var t=this.date.split("T")[0]+"T000000";$.get("https://api.sncf.com/v1/coverage/sncf/vehicle_journeys/?headsign="+this.numTrain+"&since="+t+"&key="+this.sncf_key+" ",function(t){e.traitement_gares(t)}).fail(function(t){switch(t.status){case 404:e.error="Ce numéro de train ne correspond à aucun train circulant à cette date";break;case 401:e.error="Un problème d'autorisation d'accès est survenu.";break;case 403:e.error="Requête correcte mais refusée par le serveur.";break;case 500:e.error="Erreur interne liée au serveur.";break;case 404:e.error="Le service n'est pas disponible actuellement, erreur probablement liée à une maintenance";break;default:e.date.length?e.error="Une erreur inconnue est survenue lors de la recherche de ce train":e.error="Vous devez spécifier une date de voyage."}})}},traitement_gares:function(e){console.log(k()(e.disruptions)),console.log(e);for(var t=e.vehicle_journeys[0].stop_times,a=1;a<t.length;a++){parseFloat(t[a].stop_point.coord.lat),parseFloat(t[a].stop_point.coord.lon);console.log(t[a].stop_point.name),console.log("*************"),this.gares.push(t[a]),console.log(this.gares)}}},mounted:function(){this.getBagages(),this.getDepartments();var e=this,t={bounds:new google.maps.LatLngBounds(new google.maps.LatLng(44.1939019,-1.2614241),new google.maps.LatLng(45.573636,.315137)),componentRestrictions:{country:"fr"}},a=this.$refs.autocomplete_end;if(new google.maps.places.Autocomplete(a,t).addListener("place_changed",function(){e.endPlace=this.getPlace(),e.verifyDepartment(e.endPlace,"end")}),"address"==this.type){var r=this.$refs.autocomplete_start;new google.maps.places.Autocomplete(r,t).addListener("place_changed",function(){e.startPlace=this.getPlace(),e.verifyDepartment(e.startPlace,"start")})}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"home"}},[a("demand-header"),e._v(" "),a("v-stepper",{model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:e.step>1,step:"1"}},[e._v(" Prise en charge et livraison")]),e._v(" "),a("v-divider"),e._v(" "),a("v-stepper-step",{attrs:{complete:e.step>2,step:"2"}},[e._v("Mes bagages")]),e._v(" "),a("v-divider"),e._v(" "),a("v-stepper-step",{attrs:{step:"3"}},[e._v("Récapitulatif")])],1),e._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-subheader",[e._v(" Prise en charge et livraison")]),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-card-title",[e._v(" Informations de prise en charge")])],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[e.error.length?a("div",[a("alert",{attrs:{message:e.error}})],1):e._e()])],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},e._l(e.errors,function(t){return a("div",[""!=t?a("alert",{attrs:{message:t}}):e._e()],1)}))],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs6:"",sm6:"","offset-sm3":""}},[a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.date,transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(t){e.date=t}}},[a("v-text-field",{attrs:{slot:"activator",label:"Date de prise en charge","prepend-icon":"event",readonly:""},slot:"activator",model:{value:e.displayDate,callback:function(t){e.displayDate=t},expression:"displayDate"}}),e._v(" "),a("v-date-picker",{attrs:{min:e.minDate,color:"green darken-3","no-title":"",scrollable:"",locale:"fr"},on:{input:function(t){e.$refs.menu.save(e.date)}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),e._v(" "),"address"==e.type?a("div",[a("v-flex",{attrs:{xs6:"",sm6:"","offset-sm3":""}},[a("v-menu",{ref:"menu2",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.time,transition:"scale-transition","offset-y":"",lazy:"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(t){e.time=t}}},[a("v-text-field",{attrs:{slot:"activator",label:"Heure de prise en charge","prepend-icon":"access_time",readonly:""},slot:"activator",model:{value:e.displayTime,callback:function(t){e.displayTime=t},expression:"displayTime"}}),e._v(" "),a("v-time-picker",{attrs:{min:"6:30",max:"22:55",format:"24hr",color:"green darken-3","no-title":"",scrollable:"",locale:"fr"},on:{change:function(t){e.$refs.menu2.save(e.time)}},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1)],1):e._e()],1),e._v(" "),"train"==e.type?a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs6:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.numTrain,expression:"numTrain"}],attrs:{pattern:"\\d*",type:"number",placeholder:"Numéro de train"},domProps:{value:e.numTrain},on:{input:[function(t){t.target.composing||(e.numTrain=t.target.value)},e.traitementTrain],click:e.resetData}})]),e._v(" "),e.gares.length?a("v-flex",{attrs:{xs6:""}},[a("v-select",{attrs:{items:e.gares,"item-text":"stop_point.name",label:"Choisir un arrêt","single-line":""},on:{input:e.verifGare},model:{value:e.selectedGare,callback:function(t){e.selectedGare=t},expression:"selectedGare"}})],1):e._e()],1):e._e(),e._v(" "),"flight"==e.type?a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.numVol,expression:"numVol"}],attrs:{type:"text",maxlength:"6",placeholder:"Numéro de vol"},domProps:{value:e.numVol},on:{input:[function(t){t.target.composing||(e.numVol=t.target.value)},e.traitementVol],click:e.resetData}})])],1):e._e(),e._v(" "),"address"==e.type?a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("input",{ref:"autocomplete_start",staticClass:"autocomplete",attrs:{placeholder:"Adresse de départ"}})])],1):e._e(),e._v(" "),a("v-divider"),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-card-title",[e._v(" Informations sur la livraison ")])],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("input",{ref:"autocomplete_end",staticClass:"autocomplete",attrs:{placeholder:"Adresse de livraison"}})])],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-switch",{attrs:{label:"Livraison dès que possible",color:"success"},model:{value:e.livraisonDirecte,callback:function(t){e.livraisonDirecte=t},expression:"livraisonDirecte"}})],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{disabled:!e.isFormOk(),color:"green darken-1",dark:""},nativeOn:{click:function(t){e.step=2}}},[e._v("Suivant")])],1)],1),e._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[e._v("\n    Mes bagages\n\n    "),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.ajoutBagage("cabine")}}},[e._v("Ajout bagage cabine")]),e._v(" "),e._l(e.bagagesCabine,function(t){return a("div",{key:t.id},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{icon:"",flat:"",color:"red darken-4"},nativeOn:{click:function(a){e.supprBagage(e.bagagesCabine,t)}}},[a("v-icon",[e._v("delete")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",flat:"",color:"teal"}},[a("v-icon",[e._v("photo")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Nom du bagage"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"bag.name"}})],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Description"},model:{value:t.descr,callback:function(a){e.$set(t,"descr",a)},expression:"bag.descr"}})],1)],1),e._v(" "),a("v-divider")],1)})],2)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.ajoutBagage("soute")}}},[e._v("Ajout bagage soute ")]),e._v(" "),e._l(e.bagagesSoute,function(t){return a("div",{key:t.id},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{icon:"",flat:"",color:"red darken-4"},nativeOn:{click:function(a){e.supprBagage(e.bagagesSoute,t)}}},[a("v-icon",[e._v("delete")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",flat:"",color:"teal"}},[a("v-icon",[e._v("photo")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"nom du bagage"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"bag.name"}})],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Description"},model:{value:t.descr,callback:function(a){e.$set(t,"descr",a)},expression:"bag.descr"}})],1)],1),e._v(" "),a("v-divider")],1)})],2)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.ajoutBagage("autre")}}},[e._v("Ajout bagage autre")]),e._v(" "),e._l(e.bagagesAutre,function(t){return a("div",{key:t.id},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{icon:"",flat:"",color:"red darken-4"},nativeOn:{click:function(a){e.supprBagage(e.bagagesAutre,t)}}},[a("v-icon",[e._v("delete")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",flat:"",color:"teal"}},[a("v-icon",[e._v("photo")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{required:"",box:"",label:"nom du bagage",rules:[function(){return t.name.length>0||"Il est requis de nommer votre bagage"}]},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"bag.name"}})],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Description"},model:{value:t.descr,callback:function(a){e.$set(t,"descr",a)},expression:"bag.descr"}})],1)],1),e._v(" "),a("v-divider")],1)})],2)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"orange lighten-1",dark:""},nativeOn:{click:function(t){e.step=1}}},[e._v("Précédent")]),e._v(" "),a("v-btn",{attrs:{disabled:!e.verifBagage(),color:"green darken-1",dark:""},nativeOn:{click:function(t){e.step=3}}},[e._v("Suivant")])],1)],1),e._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("v-card",[e._v("\n      "+e._s(e.reponse())+"\n    ")]),e._v(" "),a("v-btn",{attrs:{color:"orange lighten-1",dark:""},nativeOn:{click:function(t){e.step=2}}},[e._v("Précédent")]),e._v(" "),a("v-btn",{attrs:{color:"green darken-1",dark:""},nativeOn:{click:function(t){e.reponse()}}},[e._v("Valider ")])],1)],1)],1)],1)},staticRenderFns:[]};var I=a("VU/8")(T,w,!1,function(e){a("Y/FT")},"data-v-ceae65e6",null).exports,S={data:function(){return{bagagesCabine:[],bagagesSoute:[],bagagesAutre:[],connecting:!1}},mounted:function(){this.getBagages();var e="http://dev-deliverbag.supconception.fr/customers/profile?mobile_token="+localStorage.getItem("deviceId"),t=cordova.InAppBrowser.open(e,"_blank","location=no,zoom=no"),a='$("#chk_mobile_token").val("'+localStorage.getItem("deviceId")+'")';t.executeScript({code:a})},methods:{getBagages:function(){var e=this;$.ajax({url:"http://dev-deliverbag.supconception.fr/mobile/bags/users/"+localStorage.getItem("deviceId"),type:"GET",datatype:"jsonp",success:function(t){if(e.connecting=!0,e.bagagesCabine=[],e.bagagesSoute=[],e.bagagesAutre=[],t=JSON.parse(t),console.log(t),t.length)for(var a=0;a<t.length;a++)switch(console.log(k()(t[a])),t[a].type_id){case 1:e.bagagesCabine.push(t[a]);break;case 2:e.bagagesSoute.push(t[a]);break;case 3:e.bagagesAutre.push(t[a])}e.connecting=!1},error:function(t){alert("erreur de connexion"),console.log(t),e.connecting=!1}})},ajoutBagage:function(e){switch(e){case"cabine":this.bagagesCabine.push({name:"",descr:""});break;case"soute":this.bagagesSoute.push({name:"",descr:""});break;case"autre":this.bagagesAutre.push({name:"",descr:""})}},supprBagage:function(e,t){var a=e.indexOf(t);a>-1&&e.splice(a,1)},updateBagages:function(){var e={bagages:{1:this.bagagesCabine,2:this.bagagesSoute,3:this.bagagesAutre},mobile_token:localStorage.getItem("deviceId"),_method:"put"};console.log(k()(e));var t=this;$.ajax({url:"http://dev-deliverbag.supconception.fr/mobile/bags/users",type:"POST",data:e,success:function(e){t.getBagages()},error:function(e){alert(e),console.log(e),t.getBagages()}})},verifBagage:function(){return!this.connecting&&this.bagageOk(this.bagagesAutre)&&this.bagageOk(this.bagagesSoute)&&this.bagageOk(this.bagagesCabine)},bagageOk:function(e){var t=[],a=!0;if(e.length)for(var r=0;r<e.length;r++)""==e[r].name?a=!1:t.includes(e[r].name)?a=!1:t.push(e[r].name);return a},swipeRight:function(){this.$router.replace({path:"demand"})}}},D={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"touch",rawName:"v-touch",value:{right:e.swipeRight},expression:"{\n  right:swipeRight\n  }"}]},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.ajoutBagage("cabine")}}},[e._v("Ajout bagage cabine")]),e._v(" "),e._l(e.bagagesCabine,function(t){return a("div",{key:t.id},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{icon:"",flat:"",color:"red darken-4"},nativeOn:{click:function(a){e.supprBagage(e.bagagesCabine,t)}}},[a("v-icon",[e._v("delete")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",flat:"",color:"teal"}},[a("v-icon",[e._v("photo")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{required:"",box:"",label:"nom du bagage",rules:[function(){return t.name.length>0||"Il est requis de nommer votre bagage"}]},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"bag.name"}})],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Description"},model:{value:t.descr,callback:function(a){e.$set(t,"descr",a)},expression:"bag.descr"}})],1)],1),e._v(" "),a("v-divider")],1)})],2)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.ajoutBagage("soute")}}},[e._v("Ajout bagage soute ")]),e._v(" "),e._l(e.bagagesSoute,function(t){return a("div",{key:t.id},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{icon:"",flat:"",color:"red darken-4"},nativeOn:{click:function(a){e.supprBagage(e.bagagesSoute,t)}}},[a("v-icon",[e._v("delete")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",flat:"",color:"teal"}},[a("v-icon",[e._v("photo")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{required:"",box:"",label:"nom du bagage",rules:[function(){return t.name.length>0||"Il est requis de nommer votre bagage"}]},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"bag.name"}})],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Description"},model:{value:t.descr,callback:function(a){e.$set(t,"descr",a)},expression:"bag.descr"}})],1)],1),e._v(" "),a("v-divider")],1)})],2)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.ajoutBagage("autre")}}},[e._v("Ajout bagage autre")]),e._v(" "),e._l(e.bagagesAutre,function(t){return a("div",{key:t.id},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{icon:"",flat:"",color:"red darken-4"},nativeOn:{click:function(a){e.supprBagage(e.bagagesAutre,t)}}},[a("v-icon",[e._v("delete")])],1),e._v(" "),a("v-btn",{attrs:{icon:"",flat:"",color:"teal"}},[a("v-icon",[e._v("photo")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{required:"",box:"",label:"nom du bagage",rules:[function(){return t.name.length>0||"Il est requis de nommer votre bagage"}]},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"bag.name"}})],1),e._v(" "),a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{box:"",label:"Description"},model:{value:t.descr,callback:function(a){e.$set(t,"descr",a)},expression:"bag.descr"}})],1)],1),e._v(" "),a("v-divider")],1)})],2)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[a("v-btn",{attrs:{disabled:!e.verifBagage(),color:"green lighten-1",dark:""},nativeOn:{click:function(t){e.updateBagages()}}},[e._v("Mettre à jour mes bagages")])],1)],1),e._v(" "),a("db-menu")],1)},staticRenderFns:[]};var O=a("VU/8")(S,D,!1,function(e){a("IMfB")},null,null).exports,P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-bottom-nav",{attrs:{value:!0,active:e.element,fixed:""},on:{"update:active":function(t){e.element=t}}},[a("v-btn",{attrs:{flat:"",color:"green darken-2",value:"left",to:"/courses"}},[a("span",[e._v("Mes courses")]),e._v(" "),a("v-icon",[e._v("history")])],1),e._v(" "),a("v-btn",{attrs:{flat:"",color:"green darken-2",value:"main",to:"/demands"}},[a("span",[e._v("Prendre une demande")]),e._v(" "),a("v-icon",[e._v("pan_tool")])],1),e._v(" "),a("v-btn",{attrs:{flat:"",color:"green darken-2",value:"right",to:"/demands"}},[a("span",[e._v("Profil et paramètres")]),e._v(" "),a("v-icon",[e._v("settings")])],1)],1)},staticRenderFns:[]};var A=a("VU/8")({data:function(){return{element:"main"}}},P,!1,function(e){a("Aik8")},"data-v-809aa724",null).exports,j=a("i6h5"),C=a.n(j),B={data:function(){return{map:null,user_pos:null,user_marker:null,active_demand:null,tabs:["Afficher sur la carte","Afficher toutes les demandes"],deliveries:null}},methods:{checkGps:function(){cordova.plugins.locationAccuracy.request(function(){this.initMap(),this.initUserMarker(),this.initUserPos()},function(){alert("Erreur - Tried to access GPS")},cordova.plugins.locationAccuracy.REQUEST_PRIORITY_HIGH_ACCURACY)},initMap:function(){this.map=new google.maps.Map(document.getElementById("google-map"),{center:{lat:48.68439,lng:6.18496},zoom:12,disableDefaultUI:!0,gestureHandling:"greedy",styles:C.a})},initUserMarker:function(){var e=this;e.user_marker=new google.maps.Marker({position:{lat:0,lng:0}}),e.user_marker.setMap(e.map),e.user_marker.setVisible(!1),e.user_marker.addListener("click",function(){e.map.setZoom(15),e.map.setCenter(e.user_marker.getPosition());e.user_marker.getPosition().lat(),e.user_marker.getPosition().lng();e.methode()})},initUserPos:function(){var e=this;e.user_pos={lat:0,lng:0},window.timer=setInterval(function(){navigator.geolocation.getCurrentPosition(function(t){e.user_pos={lat:t.coords.latitude,lng:t.coords.longitude},e.user_marker.setPosition(e.user_pos),e.user_marker.getVisible()||e.user_marker.setVisible(!0)},function(){alert("fail - get current pos")})},3e3)},clearTimer:function(){clearInterval(window.timer)},getDeliveries:function(){var e=this;$.ajax({url:"https://dev-deliverbag.supconception.fr/deliveries",dataType:"jsonp",success:function(t){console.log(t);var a=JSON.parse(t);e.deliveries=a;for(var r=0;r<a.length;r++){var s=new google.maps.InfoWindow({}),n=new google.maps.Marker({position:{lat:a[r].start_position.lat,lng:a[r].start_position.lng},infos:a[r]});n.setMap(e.map);var i=new google.maps.Marker({position:{lat:a[r].end_position.lat,lng:a[r].end_position.lng}});n.addListener("click",function(){e.active_demand=this.infos,s.open(e.map,n),i.setMap(e.map)}),s.addListener("closeclick",function(){e.active_demand=null,i.setMap(null)})}},error:function(e){console.log(e)}})},addDeliveriesMarkers:function(){}},mounted:function(){this.initMap(),this.initUserMarker(),this.initUserPos(),this.getDeliveries()},destroyed:function(){this.clearTimer()}},E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"home"}},[a("p",[e._v(" Voici les demandes clients actuelles ")]),e._v(" "),a("v-container",{class:{"px-0":e.$vuetify.breakpoint.xsOnly}},[a("v-tabs",{attrs:{"fixed-tabs":""}})],1),e._v(" "),a("div",{attrs:{id:"google-map"}}),e._v(" "),null!==e.active_demand?a("div",{attrs:{id:"demand-description"}},[a("p",[e._v(" Descriptif de cette demande ")]),e._v(" "),a("ul",[a("li",[a("p",[e._v(" Commentaire : "+e._s(e.active_demand.comment)+" ")]),e._v(" "),a("p",[e._v(" Prix : "+e._s(e.active_demand.price)+" ")]),e._v(" "),a("p",[e._v(" Adresse de prise en charge : "+e._s(e.active_demand.start_position.address)+" ")]),e._v(" "),a("p",[e._v(" Adresse de livraison : "+e._s(e.active_demand.end_position.address)+" ")])])])]):e._e(),e._v(" "),a("p",[e._v(" Fin de la carte ")]),e._v(" "),a("db-menu")],1)},staticRenderFns:[]};var L=a("VU/8")(B,E,!1,function(e){a("CyLD")},"data-v-1ff4445a",null).exports;r.a.use(i.a),r.a.component("db-menu",y),r.a.component("db-menu-driver",A),r.a.component("demand-header",u),r.a.component("alert",l);var V=new i.a({mode:"history",routes:[{path:"/demande-form",component:I,name:"demande-form",props:!0},{path:"/courses",component:b},{path:"/demands",component:L},{path:"/demand",component:f},{path:"/profile-customer",component:O},{path:"/",component:p},{path:"*",redirect:"/"}]});a("7zck"),a("gJtD");r.a.config.productionTip=!1,r.a.use(n.a),new r.a({el:"#app",router:V}).$mount("#app")},WG81:function(e,t){},"Y/FT":function(e,t){},gJtD:function(e,t){},i6h5:function(e,t){e.exports=[{featureType:"administrative",stylers:[{visibility:"on"}]},{featureType:"administrative.country",stylers:[{visibility:"on"}]},{featureType:"administrative.land_parcel",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.province",stylers:[{visibility:"on"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#e9e5dc"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{color:"#b8cb93"},{visibility:"on"}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.attraction",stylers:[{visibility:"off"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.government",stylers:[{visibility:"off"}]},{featureType:"poi.medical",stylers:[{visibility:"off"}]},{featureType:"poi.park",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#ccdca1"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{hue:"#ff0000"},{saturation:-100},{lightness:100}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#808080"},{lightness:54},{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#767676"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",stylers:[{weight:"1.74"}]},{featureType:"road.arterial",elementType:"labels.text",stylers:[{hue:"#ff0000"},{visibility:"on"},{weight:"4.98"}]},{featureType:"road.highway",stylers:[{visibility:"off"}]},{featureType:"road.highway.controlled_access",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{visibility:"on"},{weight:"0.01"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",stylers:[{visibility:"off"}]},{featureType:"transit.station.bus",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:"#6abcd1"},{saturation:"0"},{lightness:"0"},{gamma:"1"},{weight:"1"}]}]},"l+pG":function(e,t){},tzI6:function(e,t){}},[0]);
//# sourceMappingURL=app.bc3ecbeb56c6f3b852d0.js.map